podTemplate(label: 'clairctl', 
	containers: [
		containerTemplate(name: 'docker', image: 'ptcos/docker-client:latest', alwaysPullImage: true, ttyEnabled: true, command: '/bin/sh -c', args: 'cat')
	],
	volumes: [
		hostPathVolume(hostPath: '/var/run/docker.sock', mountPath: '/var/run/docker.sock')
	]
) {

	node('clairctl') {
		checkout scm

		container('docker') {
			docker.withRegistry('https://registry.hub.docker.com','docker-hub-credentials') {

				def image = docker.image("ptcos/docker-client")
				image.push("latest")
				image.push("1.1.${env.BUILD_NUMBER}")
			}
		}
	}
}