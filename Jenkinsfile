podTemplate(label: 'clairctl', 
	containers: [
		containerTemplate(name: 'golang', image: 'golang:1.8', ttyEnabled: true, command: '/bin/sh -c', args: 'cat'),
		containerTemplate(name: 'docker', image: 'ptcos/docker-client:latest', alwaysPullImage: true, ttyEnabled: true, command: '/bin/sh -c', args: 'cat')
	],
	volumes: [
		hostPathVolume(hostPath: '/var/run/docker.sock', mountPath: '/var/run/docker.sock')
	]
) {

	node('clairctl') {
		checkout scm

		container('golang') {
			sh """
			go-wrapper download github.com/jgsqware/clairctl
			go-wrapper install github.com/jgsqware/clairctl
			mv /go/bin/clairctl $WORKSPACE/clairctl
			"""
		}

		container('docker') {
			sh """
			docker build -t ptcos/docker-client:test .
			docker images
			"""
		}
	}
}